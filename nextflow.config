/*
 * -------------------------------------------------
 *  TRON-Bioinformatics/covigator-ngs-pipeline Nextflow config file
 * -------------------------------------------------
 */

params.tronflow_bwa_version = "v1.2.0"
params.tronflow_bam_preprocessing_version = "v1.4.0"
params.tronflow_variant_normalization_version = "v1.0.1"

params.reference = "$baseDir/test_data/Sars_cov_2.ASM985889v3.dna.toplevel.fa"
params.gff = "$baseDir/test_data/Sars_cov_2.ASM985889v3.101.gff3"

profiles {
  conda { process.conda = "$baseDir/environment.yml" }
  debug { process.beforeScript = 'echo $HOSTNAME' }
  test {
    params.input_files = "$baseDir/test_data/input_data.txt"
    params.cpus = 1
    params.memory = "2g"
    timeline.enabled = false
    report.enabled = false
    trace.enabled = false
    dag.enabled = false
  }
}

// Export this variable to prevent local Python libraries from conflicting with those in the container
env {
  PYTHONNOUSERSITE = 1
}

// Capture exit codes from upstream processes when piping
process.shell = ['/bin/bash', '-euo', 'pipefail']

VERSION = '0.2.0'

manifest {
  name = 'TRON-Bioinformatics/covigator-ngs-pipeline'
  author = 'Pablo Riesgo-Ferreiro, Patrick Sorn, Thomas Bukur'
  homePage = 'https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline'
  description = 'A Nextflow pipeline to process NGS data from SARS-CoV-2'
  mainScript = 'main.nf'
  nextflowVersion = '>=19.10.0'
  version = VERSION
}

params.help_message = """
Covigator NGS pipeline v${VERSION}

Usage:
    nextflow run tron-bioinformatics/covigator-ngs-pipeline -profile conda --input_files input_files

Input:
    * input_files: the path to a tab-separated values file containing in each row the sample name and the FASTQ files.
    For single-paired samples, the third column for fastq2 can be left empty, but the column needs to exist.
    The input file does not have header!
    Example input file:
    name1	name1.1.fastq	name1.2.fastq
    name2	name2.1.fastq	name2.2.fastq

    * output: the folder where to publish output

Optional input:
    * memory: the ammount of memory used by each job (default: 3g)
    * cpus: the number of CPUs used by each job (default: 1)

Output:
    * Output a normalized and annotated VCF file.
    """
